<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MBTI 궁합 분석 앱</title>
  <style>
    body { font-family: 'Jua', Arial, sans-serif; max-width: 600px; margin: 40px auto; padding: 20px; text-align: center; }
    select, button { padding: 12px; font-size: 1.1rem; margin: 10px; border-radius: 8px; border: 2px solid #7e57c2; }
    .result { background: #f3e5f5; border-radius: 12px; padding: 20px; margin-top: 30px; text-align: left; }
    h3 { color: #5e35b1; }
    ul { margin-bottom: 0; }
    .bar-container { background: #ede7f6; border-radius: 8px; margin: 24px 0 16px 0; height: 32px; width: 100%; max-width: 350px; display: flex; align-items: center; }
    .bar { background: #7e57c2; height: 100%; border-radius: 8px 0 0 8px; transition: width 0.7s; }
    .score-label { position: absolute; font-size: 1.2rem; color: #5e35b1; font-weight: bold; margin-left: 10px; }
    .bar-wrap { position: relative; display: inline-block; width: 100%; }
  </style>
</head>
<body>
  <h1>🔮 MBTI 궁합 분석 앱</h1>
  <p>나와 상대방의 MBTI를 선택하면<br>성향 유사도와 주요 차이점을 분석해드려요!</p>
  
  <div>
    <select id="myMbti">
      <option value="">나의 MBTI</option>
      <option value="ISTJ">ISTJ</option>
      <option value="ISFJ">ISFJ</option>
      <option value="INFJ">INFJ</option>
      <option value="INTJ">INTJ</option>
      <option value="ISTP">ISTP</option>
      <option value="ISFP">ISFP</option>
      <option value="INFP">INFP</option>
      <option value="INTP">INTP</option>
      <option value="ESTP">ESTP</option>
      <option value="ESFP">ESFP</option>
      <option value="ENFP">ENFP</option>
      <option value="ENTP">ENTP</option>
      <option value="ESTJ">ESTJ</option>
      <option value="ESFJ">ESFJ</option>
      <option value="ENFJ">ENFJ</option>
      <option value="ENTJ">ENTJ</option>
    </select>

    <select id="otherMbti">
      <option value="">상대방 MBTI</option>
      <option value="ISTJ">ISTJ</option>
      <option value="ISFJ">ISFJ</option>
      <option value="INFJ">INFJ</option>
      <option value="INTJ">INTJ</option>
      <option value="ISTP">ISTP</option>
      <option value="ISFP">ISFP</option>
      <option value="INFP">INFP</option>
      <option value="INTP">INTP</option>
      <option value="ESTP">ESTP</option>
      <option value="ESFP">ESFP</option>
      <option value="ENFP">ENFP</option>
      <option value="ENTP">ENTP</option>
      <option value="ESTJ">ESTJ</option>
      <option value="ESFJ">ESFJ</option>
      <option value="ENFJ">ENFJ</option>
      <option value="ENTJ">ENTJ</option>
    </select>
  </div>
  
  <button onclick="generateAdvice()">분석하기</button>
  <div class="result" id="result"></div>

  <script>
    // MBTI 차원별 행동/선호 예시
    const prefer = {
      E: ["함께 어울리는 활동", "즉각적인 반응", "활발한 대화"],
      I: ["조용한 분위기", "혼자만의 시간", "깊은 대화"],
      S: ["구체적인 칭찬", "실생활 이야기", "약속 잘 지키기"],
      N: ["미래 이야기", "아이디어 나누기", "상상력 자극 대화"],
      T: ["논리적 설명", "솔직한 피드백", "문제 해결 제안"],
      F: ["공감해주기", "감정 표현", "따뜻한 말 한마디"],
      J: ["계획 세우기", "정해진 약속 지키기", "시간 약속"],
      P: ["즉흥 제안", "유연한 태도", "새로운 경험"]
    };

    // 차원별 싫어하는 것 예시
    const dislike = {
      E: ["혼자만의 시간 방해", "무관심한 태도", "답장 늦게 하기"],
      I: ["지나친 관심 표현", "계속된 연락", "사생활 침해"],
      S: ["막연한 이야기", "계획 없는 행동", "약속 어기기"],
      N: ["지나치게 현실적인 이야기", "상상력 무시", "새로운 시도 거부"],
      T: ["감정적으로 따지기", "비논리적 주장", "돌려 말하기"],
      F: ["무뚝뚝한 말투", "공감 없는 반응", "비판적인 태도"],
      J: ["계획 없는 행동", "즉흥 약속", "일정 자주 변경"],
      P: ["지나치게 통제하기", "계획 강요", "즉흥성 무시"]
    };

    // MBTI 4글자별 차원 배열
    const mbtiDims = ["E/I", "S/N", "T/F", "J/P"];

    function getSimilarity(my, other) {
      let same = 0;
      for (let i = 0; i < 4; i++) {
        if (my[i] === other[i]) same++;
      }
      return Math.round((same / 4) * 100);
    }

    function getBothLike(my, other) {
      // 둘 다 같은 차원일 때의 선호 행동
      let both = [];
      for (let i = 0; i < 4; i++) {
        if (my[i] === other[i]) {
          both = both.concat(prefer[my[i]]);
        }
      }
      // 중복 제거
      return [...new Set(both)];
    }

    function getMyWantOtherDislike(my, other) {
      // 내가 좋아하는데, 상대는 싫어하는 것
      let result = [];
      for (let i = 0; i < 4; i++) {
        prefer[my[i]].forEach(item => {
          if (dislike[other[i]].includes(item)) {
            result.push(item);
          }
        });
      }
      return [...new Set(result)];
    }

    function getOtherWantMyDislike(my, other) {
      // 상대가 좋아하는데, 나는 싫어하는 것
      let result = [];
      for (let i = 0; i < 4; i++) {
        prefer[other[i]].forEach(item => {
          if (dislike[my[i]].includes(item)) {
            result.push(item);
          }
        });
      }
      return [...new Set(result)];
    }

    function generateAdvice() {
      const my = document.getElementById('myMbti').value;
      const other = document.getElementById('otherMbti').value;
      const resultDiv = document.getElementById('result');

      if (!my || !other) {
        resultDiv.innerHTML = '<h3>⚠️ 두 MBTI를 모두 선택해주세요!</h3>';
        return;
      }

      // 1. 유사도 계산
      const similarity = getSimilarity(my, other);

      // 2. 내가 하고싶지만 상대가 싫어하는 것
      const myWantOtherDislike = getMyWantOtherDislike(my, other);

      // 3. 상대가 좋아하지만 나는 내켜하지 않는 것
      const otherWantMyDislike = getOtherWantMyDislike(my, other);

      // 4. 둘 다 좋아할 가능성이 큰 것
      const bothLike = getBothLike(my, other);

      // 5. 그래프 그리기
      let html = `<h2>${my} ❤️ ${other} 궁합 분석</h2>`;
      html += `
        <h3>성향 유사도</h3>
        <div class="bar-wrap">
          <div class="bar-container">
            <div class="bar" style="width:${similarity}%;"></div>
          </div>
          <span class="score-label">${similarity}점 / 100점</span>
        </div>
      `;

      html += '<h3>😅 내가 하고싶어 하지만 상대방이 싫어할 수 있는 것</h3>';
      if (myWantOtherDislike.length > 0) {
        html += '<ul>';
        myWantOtherDislike.forEach(item => html += `<li>${item}</li>`);
        html += '</ul>';
      } else {
        html += '<p>특별히 해당되는 행동이 없어요!</p>';
      }

      html += '<h3>🤔 상대방이 좋아하지만 나는 내켜하지 않을 수 있는 것</h3>';
      if (otherWantMyDislike.length > 0) {
        html += '<ul>';
        otherWantMyDislike.forEach(item => html += `<li>${item}</li>`);
        html += '</ul>';
      } else {
        html += '<p>특별히 해당되는 행동이 없어요!</p>';
      }

      html += '<h3>😊 둘 다 좋아할 가능성이 큰 것</h3>';
      if (bothLike.length > 0) {
        html += '<ul>';
        bothLike.forEach(item => html += `<li>${item}</li>`);
        html += '</ul>';
      } else {
        html += '<p>공통으로 좋아할 만한 행동이 적어요. 서로의 차이를 존중해보세요!</p>';
      }

      resultDiv.innerHTML = html;
    }
  </script>
</body>
</html>

